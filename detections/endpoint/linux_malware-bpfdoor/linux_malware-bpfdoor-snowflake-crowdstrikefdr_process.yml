id: '10724.14700'
title: Linux Malware - BPFDoor
description: 'BPFDoor has been identified to be associated with Chinese threat actor
  group, Red Menshen. Capabilities as a Berkeley Packet Filter sniffer (hence the
  name) enable the malware to operating at the network layer level, the malware is
  unhindered by firewall rules and does not require any open ports. Attackers are
  able to control the implant through a "magic" password, to conduct remote code execution. '
logic_format: snowflake
logic: select * from crowdstrikefdr_process where event_time > dateadd(hour, -2, sysdate())
  and (event_platform = 'Lin' or event_platform = 'Mac') and (process ilike '%/dev/shm/kdmtmpflush%'
  or process ilike '%/dev/shm/%') and (process ilike '%--init%' or process ilike '%rm%'
  or regexp_like(process, '.*(chmod\\\s).*', 'i') or regexp_like(process, '.*(touch\\\s).*',
  'i') or regexp_like(process, '.*(cp\\\s).*', 'i') or regexp_like(process, '.*(mv\\\s).*',
  'i'))
techniques:
- defense-evasion:exploitation for defense evasion
technique_id: 
- T1211
data_category:
- EDR Logs
references:
- https://www.sandflysecurity.com/blog/bpfdoor-an-evasive-linux-backdoor-technical-analysis/
- https://www.joesandbox.com/analysis/185754/0/html
- https://doublepulsar.com/bpfdoor-an-active-chinese-global-surveillance-tool-54b078f1a896
- https://exatrack.com/public/Tricephalic_Hellkeeper.pdf
- https://www.bleepingcomputer.com/news/security/bpfdoor-stealthy-linux-malware-bypasses-firewalls-for-remote-access/
