id: '10724.24777'
title: Linux Malware - BPFDoor
description: 'BPFDoor has been identified to be associated with Chinese threat actor
  group, Red Menshen. Capabilities as a Berkeley Packet Filter sniffer (hence the
  name) enable the malware to operating at the network layer level, the malware is
  unhindered by firewall rules and does not require any open ports. Attackers are
  able to control the implant through a "magic" password, to conduct remote code execution. '
logic_format: Splunk
logic: '`get_endpoint_data` `get_endpoint_data_edr` ("*/dev/shm/kdmtmpflush*" OR "/dev/shm/*")
  ("--init" OR "rm" or TERM(chmod) OR TERM(touch) OR TERM(cp) OR TERM(mv)) | table
  _time, host, user, process, process_* | bin span=1s | stats values(*) as * by _time,
  host '
techniques:
- defense-evasion:exploitation for defense evasion
technique_id: null
data_category:
- EDR Logs
references:
- https://www.sandflysecurity.com/blog/bpfdoor-an-evasive-linux-backdoor-technical-analysis/
- https://www.joesandbox.com/analysis/185754/0/html
- https://doublepulsar.com/bpfdoor-an-active-chinese-global-surveillance-tool-54b078f1a896
- https://exatrack.com/public/Tricephalic_Hellkeeper.pdf
- https://www.bleepingcomputer.com/news/security/bpfdoor-stealthy-linux-malware-bypasses-firewalls-for-remote-access/
