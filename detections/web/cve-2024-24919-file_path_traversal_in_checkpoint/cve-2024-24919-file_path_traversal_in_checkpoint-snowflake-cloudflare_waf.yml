id: '32835.62099'
title: CVE-2024-24919 - File Path Traversal In CheckPoint
description: CVE-2024-24919 is a zero-day arbitrary file read in Check Point Security
  Gateways with the IPSec VPN or Mobile Access blades enabled, and it is currently
  being actively exploited in the wild. An unauthenticated remote attacker could leverage
  this bug to read sensitive data like password hashes, potentially enabling lateral
  movement and complete network compromise under the right circumstances. This use
  case detects attempts of exploiting CVE-2024-24919 on path /clients/MyCRL leveraging
  the CSHELL directory.
logic_format: snowflake
logic: 'select * from cloudflare_waf where event_time > dateadd(hour, -2, sysdate())
  and to_timestamp(date_part(epoch_second, event_time)) < $latest$ and (http_method
  ilike ''%GET%'' or http_method ilike ''%POST%'') and regexp_like(uri_path, ''.*(\\\/clients\\\/MyCRL).*'',
  ''i'') and regexp_like(uri_path, ''.*(\\\/CSHELL).*'', ''i'') and regexp_like(uri_path,
  ''.*(\\\.\\\.\\\/|\\\.\\\.\\\\\\|\\\.\\\.%2F|\\\.\\\.%5C|\\\.\\\.%252F|\\\.\\\.%255C|\\\.\\\.%2e%2e%2f|\\\.\\\.%2e%2e%5c).*'',
  ''i'') '
techniques:
- discovery:file and directory discovery
technique_id: 
- T1083
data_category:
- Web application firewall logs
references:
- https://censys.com/cve-2024-24919/
- https://labs.watchtowr.com/check-point-wrong-check-point-cve-2024-24919/
- https://support.checkpoint.com/results/sk/sk182336
- https://www.greynoise.io/blog/whats-going-on-with-checkpoint-cve-2024-24919
- https://github.com/seed1337/CVE-2024-24919-POC/blob/main/exploit.py
