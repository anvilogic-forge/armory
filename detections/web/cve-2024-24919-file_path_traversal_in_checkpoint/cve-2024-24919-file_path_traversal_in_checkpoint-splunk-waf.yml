id: '32835.58300'
title: CVE-2024-24919 - File Path Traversal In CheckPoint
description: CVE-2024-24919 is a zero-day arbitrary file read in Check Point Security
  Gateways with the IPSec VPN or Mobile Access blades enabled, and it is currently
  being actively exploited in the wild. An unauthenticated remote attacker could leverage
  this bug to read sensitive data like password hashes, potentially enabling lateral
  movement and complete network compromise under the right circumstances. This use
  case detects attempts of exploiting CVE-2024-24919 on path /clients/MyCRL leveraging
  the CSHELL directory.
logic_format: Splunk
logic: '`get_web_data` `get_web_data_waf` (http_method=POST OR http_method=GET) "/clients/MyCRL"
  "CSHELL/" | regex uri_path="(\.\.\/|\.\.\\|\.\.%2F|\.\.%5C|\.\.%252F|\.\.%255C|\.\.%2e%2e%2f|\.\.%2e%2e%5c)"
  | table _time, host, user, _time, host, uri_path, uri_query, src_ip, dest_ip | bin
  span=1s | stats values(*) as * by _time, dest_ip '
techniques:
- discovery:file and directory discovery
technique_id: 
- T1083
data_category:
- Web application firewall logs
references:
- https://censys.com/cve-2024-24919/
- https://labs.watchtowr.com/check-point-wrong-check-point-cve-2024-24919/
- https://support.checkpoint.com/results/sk/sk182336
- https://www.greynoise.io/blog/whats-going-on-with-checkpoint-cve-2024-24919
- https://github.com/seed1337/CVE-2024-24919-POC/blob/main/exploit.py
