id: '33330.58988'
title: CVE-2024-28995 - Solarwinds Serv-U Directory Traversal
description: 'Solarwinds announced a high-severity directory traversal vulnerability
  affecting Serv-U FTP Server 15.4, Serv-U Gateway 15.4, and Serv-U MFT Server 15.4.
  Successful exploitation of the vulnerabilty would allow access to read sensitive
  files on the host machine. This use case detects directory traversal attempts against
  Solarwinds Serv-U functions vulnerable to the directory transversal vulnerability.
  Note: to reduce noise, consider adding logic for success events only, such as status=200.
  Vulnerability Association: CVE-2024-28995'
logic_format: snowflake
logic: select * from cloudflare_waf where event_time > dateadd(hour, -2, sysdate())
  and to_timestamp(date_part(epoch_second, event_time)) < $latest$ and http_method
  ilike 'GET' and regexp_like(uri_path, '.*(((\\\.|\\\%2E|%252e|%c0%ae|%uff0e)(\\\.|\\\%2E|%252e|%c0%ae|%uff0e)(\\\/\\\.\\\.|\\\%2F|\\\x5c|%252f|%c0%af|%u2215|%u2216))|\\\.\\\S+(\\\Wetc\\\W)).*',
  'i') and regexp_like(uri_path, '.*Internal(Dir|File).*', 'i')
techniques:
- discovery:file and directory discovery
- initial-access:exploit public-facing application
technique_id: 
- T1083
- T1190
data_category:
- Web application firewall logs
references:
- https://owasp.org/www-community/attacks/Path_Traversal
- https://attackerkb.com/topics/2k7UrkHyl3/cve-2024-28995/rapid7-analysis
