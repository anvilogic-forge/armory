id: '33330.58991'
title: CVE-2024-28995 - Solarwinds Serv-U Directory Traversal
description: 'Solarwinds announced a high-severity directory traversal vulnerability
  affecting Serv-U FTP Server 15.4, Serv-U Gateway 15.4, and Serv-U MFT Server 15.4.
  Successful exploitation of the vulnerabilty would allow access to read sensitive
  files on the host machine. This use case detects directory traversal attempts against
  Solarwinds Serv-U functions vulnerable to the directory transversal vulnerability.
  Note: to reduce noise, consider adding logic for success events only, such as status=200.
  Vulnerability Association: CVE-2024-28995'
logic_format: Splunk
logic: '`get_web_data` `get_web_data_waf` http_method=GET| regex _raw="(?i)(((\.|\%2E|%252e|%c0%ae|%uff0e)(\.|\%2E|%252e|%c0%ae|%uff0e)(\/|\%2F|\x5c|%252f|%c0%af|%u2215|%u2216))|\.\S+(\Wetc\W))"
  | regex uri_path-"(?i)Internal(Dir|File)" | table _time, host, user, action, bytes,
  bytes_in, bytes_out, dest_ip, dest_port, dest_mac, http_content_type, http_user_agent,
  site, src_ip, src_port, src_mac, status, uri_query, http_method, uri_path | bin
  span=1s | stats values(*) as * by _time, site | iplocation prefix="src_" src_ip|
  rename src_Country as src_country '
techniques:
- discovery:file and directory discovery
- initial-access:exploit public-facing application
technique_id: 
- T1083
- T1190
data_category:
- Web application firewall logs
references:
- https://owasp.org/www-community/attacks/Path_Traversal
- https://attackerkb.com/topics/2k7UrkHyl3/cve-2024-28995/rapid7-analysis
