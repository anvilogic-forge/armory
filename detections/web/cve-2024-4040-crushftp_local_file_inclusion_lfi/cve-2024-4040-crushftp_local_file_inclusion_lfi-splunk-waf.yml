id: '32562.57862'
title: CVE-2024-4040 - CrushFTP Local File Inclusion (LFI)
description: 'All CrushFTP versions before 10.7.1 and 11.1.0 are affected by CVE-2024-4040
  which states that unauthenticated remote attackers can read files from the filesystem
  outside of the VFS Sandbox. This use case detects GET or POST requests containing
  specific parameters known to trigger this vulnerability. Vulnerability Association:
  CVE-2024-4040'
logic_format: Splunk
logic: '`get_web_data` `get_web_data_waf` (http_method=GET OR http_method=POST) ("paths=<INCLUDE>"
  OR ("paths:" "<INCLUDE>")) "</INCLUDE>" | table _time, host, user, _time, host,
  uri_path, uri_query, src_ip, dest_ip | bin span=1s | stats values(*) as * by _time,
  dest_ip | lookup dnslookup clientip as src_ip OUTPUT clienthost as src_dns | iplocation
  prefix="src_" src_ip | rename src_Country as src_country '
techniques:
- discovery:file and directory discovery
technique_id: 
- T1083
data_category:
- Web application firewall logs
references:
- https://github.com/the-emmons/CVE-2023-43177/releases/tag/crushftp_software
- https://github.com/airbus-cert/CVE-2024-4040
- https://www.tenable.com/blog/cve-2024-4040-crushftp-virtual-file-system-vfs-sandbox-escape-vulnerability-exploited
- https://github.com/Stuub/CVE-2024-4040-SSTI-LFI-PoC/blob/main/crushed.py
- https://www.youtube.com/watch?v=etHDJWYElso
