id: '32426.57636'
title: CVE-2024-4323 - Monitoring Vulnerable API Trace Endpoints
description: Based on the vulnerability details for Fluent Bit - CVE-2024-4323 monitoring
  any request to /api/v1/trace or /api/v1/traces could potentially be malicious if
  it attempts to exploit the memory corruption issue. Monitoring these endpoints is
  a direct way to catch potentially malicious activity early.
logic_format: snowflake
logic: 'select * from cloudflare_waf where event_time > dateadd(hour, -2, sysdate())
  and to_timestamp(date_part(epoch_second, event_time)) < $latest$ and (http_method
  ilike ''GET'' or http_method ilike ''POST'') and (regexp_like(uri_path, ''.*\\\/api\\\/v1\\\/trace.*'',
  ''i'') OR regexp_like(uri_path, ''.*\\\/api\\\/v1\\\/traces.*'', ''i'')) '
techniques:
- initial-access:exploit public-facing application
technique_id: 
- T1190
data_category:
- Web application firewall logs
references:
- https://www.tenable.com/security/research/tra-2024-17
- https://www.tenable.com/blog/linguistic-lumberjack-attacking-cloud-services-via-logging-endpoints-fluent-bit-cve-2024-4323
