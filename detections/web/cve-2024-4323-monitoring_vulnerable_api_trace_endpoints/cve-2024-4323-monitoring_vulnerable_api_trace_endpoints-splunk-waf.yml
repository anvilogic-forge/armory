id: '32426.57630'
title: CVE-2024-4323 - Monitoring Vulnerable API Trace Endpoints
description: Based on the vulnerability details for Fluent Bit - CVE-2024-4323 monitoring
  any request to /api/v1/trace or /api/v1/traces could potentially be malicious if
  it attempts to exploit the memory corruption issue. Monitoring these endpoints is
  a direct way to catch potentially malicious activity early.
logic_format: Splunk
logic: '`get_web_data` `get_web_data_waf` (http_method=GET OR http_method=POST) AND
  ("/api/v1/trace" OR "/api/v1/traces") | table _time, host, user _time, host, uri_path,
  uri_query, src_ip, dest_ip | bin span=1s | stats values(*) as * by _time, dest_ip
  | lookup dnslookup clientip as src_ip OUTPUT clienthost as src_dns | iplocation
  prefix="src_" src_ip | rename src_Country as src_country '
techniques:
- initial-access:exploit public-facing application
technique_id: 
- T1190
data_category:
- Web application firewall logs
references:
- https://www.tenable.com/security/research/tra-2024-17
- https://www.tenable.com/blog/linguistic-lumberjack-attacking-cloud-services-via-logging-endpoints-fluent-bit-cve-2024-4323
