id: '27873.50749'
title: Potential CVE-2024-21893 Command Injection
description: CVE-2024-21893 is an SSRF vulnerability in the SAML component of Ivanti
  Connect Secure. The Python back end that services the /api/v1/license/keys-status
  endpoint listens on a locally bound port 8090, making it vulnerable to command injection
  via HTTP GET requests. This use case detects GET requests to http://127.0.0.1:8090/api/v1/license/keys-status
  containing command injection values which can indicate attempts to exploit the SSRF
  vulnerability for command injection.
logic_format: snowflake
logic: 'select * from cloudflare_waf where event_time > dateadd(hour, -2, sysdate())
  and to_timestamp(date_part(epoch_second, event_time)) < $latest$ and http_method
  ilike ''GET'' and regexp_like(uri_path, ''.*http:\\\/\\\/127\\\.0\\\.0\\\.1:8090\\\/api\\\/v1\\\/license\\\/keys-status.*python.*-c.*'',
  ''i'') '
techniques:
- initial-access:exploit public-facing application
technique_id: null
data_category:
- Web application firewall logs
references:
- https://attackerkb.com/topics/FGlK1TVnB2/cve-2024-21893/rapid7-analysis
