id: '28097.51138'
title: ScreenConnect Authentication Bypass Exploitation - WAF
description: ConnectWise ScreenConnect is a popular remote desktop solution. ConnectWise
  released an advisory detailing a critical authentication bypass vulnerabilty affecting
  ScreenConnect versions prior to 23.9.8. A Proof of Concept was released by Watchtowr
  demonstrating the ability to add a new administrative user in ScreenConnect with
  crafted This use case detects HTTP POST or GET requests to SetupWizard.aspx containing
  the __VIEWSTATE parameter.
logic_format: Splunk
logic: '`get_web_data` `get_web_data_access_logs` (http_method=POST OR http_method=GET)
  "SetupWizard.aspx" "__VIEWSTATE" | table _time, host, user _time, host, uri_path,
  uri_query, src_ip, tag, status, http_method, form_data, dest_ip | bin span=60s |
  stats values(*) as * by _time, host | lookup dnslookup clientip as src_ip OUTPUT
  clienthost as src_dns | iplocation prefix="src_" src_ip | rename src_Country as
  src_country '
techniques:
- initial-access:exploit public-facing application
technique_id: 
- T1190
data_category:
- Web logs
references:
- https://github.com/watchtowrlabs/connectwise-screenconnect_auth-bypass-add-user-poc
- https://www.huntress.com/blog/detection-guidance-for-connectwise-cwe-288-2
