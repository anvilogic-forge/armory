id: '9182.12436'
title: Spring-Cloud-Function - CVE-2022-22963
description: When using routing functionality it is possible for a user to provide
  a specially crafted SpEL as a routing-expression that may result in access to local
  resources.. This use case looks for parameters associated with available PoC for
  CVE-2022-22963
logic_format: Splunk
logic: '`get_web_data` `get_web_data_waf` (TERM(POST) OR TERM(ALLOW)) "*spring.cloud.function.routing-expression*"
  TERM(exec) | rex field=_raw (?<string>"(?i)spring.cloud.function.routing-expression.*?exec((\(.*?\))|(\{.*?\})|(\[.*?\]))?")|
  table _time, host, user, uri_path, uri_query, src_ip, tag, status, dest_ip, string
  | bin span=1s | stats values(*) as * by _time, host '
techniques:
- initial-access:exploit public-facing application
technique_id: 
- T1190
data_category:
- Web application firewall logs
references:
- https://github.com/RanDengShiFu/CVE-2022-22963
- https://www.cyberkendra.com/2022/03/springshell-rce-0-day-vulnerability.html
