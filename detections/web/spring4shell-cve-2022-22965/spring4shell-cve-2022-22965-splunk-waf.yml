id: '9220.12456'
title: Spring4Shell - CVE-2022-22965
description: Spring4Shell is vulnerability that exists in the Spring core with the
  JDK version greater or equal to 9.0. This use case looks for parameters associated
  with available PoCs. - CVE-2022-22965
logic_format: Splunk
logic: '`get_web_data` `get_web_data_waf` (TERM(POST) OR TERM(ALLOW)) (TERM(runtime)
  TERM(exec)) OR "*class.module.classLoader.resources.context.parent.pipeline.first.pattern=%25%7B*"
  OR "*class.module.classLoader.resources.context.parent.pipeline.first.pattern=\%\{*"
  | rex field=_raw (?<string>"(?i)((class.module.classLoader.resources.context.parent.pipeline.first.pattern=%25%7B)|(runtime.*?exec))\S+")
  | table _time, host, user, uri_path, uri_query, src_ip, tag, status, dest_ip, string
  | bin span=1s | stats values(*) as * by _time, host '
techniques:
- initial-access:exploit public-facing application
technique_id: 
- T1190
data_category:
- Web application firewall logs
references:
- https://www.lunasec.io/docs/blog/spring-rce-vulnerabilities/
- https://github.com/BobTheShoplifter/Spring4Shell-POC
